{"code":"!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=4)}([function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=o(r(5)),a=o(r(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=!0,c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),s&&e.writeToLog(\"Debug mode enabled\",!0),e.writeToLog(\"Death Blow client starting\"),this.dBS=new a.default,this.sessionId=this.dBS.createSession(),e.writeToLog(\"Session ID: \"+this.sessionId),this.dBS.addPlayer(\"Player 1\",this.sessionId),null!=$(document.getElementById(\"battleground\"))?(this.renderer=new i.default(\"battleground\"),e.writeToLog(\"Renderer initialised\")):e.writeToError(\"No canvas found\"),this.dBS.startSession(this.sessionId);for(var t,r=!1,n=0;!r;)e.writeToLog(\"Attempting to retrieve game step #\"+n),t=this.dBS.getGameStep(this.sessionId,n),0==n?this.renderer.initialRender(t):this.renderer.renderStep(t),n++,r=t.gameEnd;e.writeToLog(\"Game ending\")}return n(e,null,[{key:\"writeToError\",value:function(t){e.writeToLog(\"ERROR: \"+t,!1)}},{key:\"writeToLog\",value:function(t){e.writeToLog(t,!1)}},{key:\"writeToLog\",value:function(e,t){var r=$(\".debug-log\");t&&(r.append(\"----------------------------\"),r.append(\"<br />\")),r.append(e),r.append(\"<br />\"),t&&(r.append(\"----------------------------\"),r.append(\"<br />\"))}}]),e}();t.default=c},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=o(r(6)),a=o(r(0));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.sessionList={}}return n(e,[{key:\"createSession\",value:function(){var e=new i.default;return this.sessionList[e.id]=e,a.default.writeToLog(\"Server session created\"),e.id}},{key:\"startSession\",value:function(e){a.default.writeToLog(\"Starting session\"),this.sessionList[e].fillPlayers(),this.sessionList[e].startSession()}},{key:\"addPlayer\",value:function(e,t){var r={};r.name=e,this.sessionList[t].addPlayer(r)}},{key:\"getGameStep\",value:function(e,t){for(var r={},n=0;Object.keys(r).length<=0;)r=this.sessionList[e].game.getGameStep(t),++n>500&&(r={gameEnded:!0});return r}}],[{key:\"createSession\",value:function(){var e=new i.default;return this.sessionList.push(e),a.default.writeToLog(\"Server session created\"),!0}}]),e}();t.default=s},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.startingPosition=0,this.stats={health:100,movement:10,damage:10,range:5,luck:1,accuracy:100,evasion:10},this.position={x:0,y:0},this.statuses={},this.action={actionType:\"none\"}}return n(e,[{key:\"setStartingPosition\",value:function(e){this.startingPosition=e}}]),e}();t.default=i},function(e,t,r){\"use strict\";r.r(t);var n=class{constructor(e){this.stage=new createjs.Stage(e),c.writeToLog(\"Stage = \"+this.stage)}initialRender(e){c.writeToLog(\"Initial render\"),this.characterCollection={};var t=this.stage;for(var r in e.characters){var n=new createjs.Shape;n.graphics.beginFill(\"red\").drawRect(0,0,5,10),n.x=e.characters[r].position.x,n.y=e.characters[r].position.y,t.addChild(n)}this.stage.update();var i=this;createjs.Ticker.framerate=60,createjs.Ticker.addEventListener(\"tick\",function(){i.stage.update()})}renderStep(e){for(var t in e.characters){var r=new createjs.Shape;r.graphics.beginFill(\"red\").drawRect(0,0,5,10),r.x=e.characters[t].position.x,r.y=e.characters[t].position.y,stage.addChild(r)}}},i=r(1),a=r.n(i);let o=!0;class s{constructor(){o&&s.writeToLog(\"Debug mode enabled\",!0),s.writeToLog(\"Death Blow client starting\"),this.dBS=new a.a,this.sessionId=this.dBS.createSession(),s.writeToLog(\"Session ID: \"+this.sessionId),this.dBS.addPlayer(\"Player 1\",this.sessionId),null!=$(document.getElementById(\"battleground\"))?(this.renderer=new n(\"battleground\"),s.writeToLog(\"Renderer initialised\")):s.writeToError(\"No canvas found\"),this.dBS.startSession(this.sessionId);for(var e,t=!1,r=0;!t;)s.writeToLog(\"Attempting to retrieve game step #\"+r),e=this.dBS.getGameStep(this.sessionId,r),0==r?this.renderer.initialRender(e):this.renderer.renderStep(e),r++,t=e.gameEnd;s.writeToLog(\"Game ending\")}static writeToError(e){s.writeToLog(\"ERROR: \"+e,!1)}static writeToLog(e){s.writeToLog(e,!1)}static writeToLog(e,t){var r=$(\".debug-log\");t&&(r.append(\"----------------------------\"),r.append(\"<br />\")),r.append(e),r.append(\"<br />\"),t&&(r.append(\"----------------------------\"),r.append(\"<br />\"))}}var c=t.default=s},function(e,t,r){\"use strict\";new(function(e){return e&&e.__esModule?e:{default:e}}(r(0)).default)},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(r(0));var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.stage=new createjs.Stage(t),i.default.writeToLog(\"Stage = \"+this.stage)}return n(e,[{key:\"initialRender\",value:function(e){i.default.writeToLog(\"Initial render\"),this.characterCollection={};var t=this.stage;for(var r in e.characters){var n=new createjs.Shape;n.graphics.beginFill(\"red\").drawRect(0,0,5,10),n.x=e.characters[r].position.x,n.y=e.characters[r].position.y,t.addChild(n)}this.stage.update();var a=this;createjs.Ticker.framerate=60,createjs.Ticker.addEventListener(\"tick\",function(){a.stage.update()})}},{key:\"renderStep\",value:function(e){for(var t in e.characters){var r=new createjs.Shape;r.graphics.beginFill(\"red\").drawRect(0,0,5,10),r.x=e.characters[t].position.x,r.y=e.characters[t].position.y,stage.addChild(r)}}}]),e}();t.default=a},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(r(7)),a=s(r(8)),o=s(r(3));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.id=\"1\",this.playerList={},this.minPlayers=1,this.maxPlayers=2}return n(e,[{key:\"addPlayer\",value:function(e){this.playerList[e.name]=new i.default(e),o.default.writeToLog(\"Player added: \"+this.playerList[e.name].name)}},{key:\"fillPlayers\",value:function(){for(;Object.keys(this.playerList).length<this.maxPlayers;){var e={name:\"bot\"};this.addPlayer(e)}}},{key:\"startSession\",value:function(){var e={},t=0;for(var t in this.playerList)e[t]=this.playerList[t].character;this.game=new a.default(e),this.game.playGame()}}]),e}();t.default=c},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(r(2));var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.name=t.name,this.character=new i.default}return n(e,[{key:\"getCharacter\",value:function(){return this.character}}]),e}();t.default=a},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(a(r(2)),a(r(3)));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),i.default.writeToLog(\"Game started\"),this.characterList=t,this.gameSteps={}}return n(e,[{key:\"getGameStep\",value:function(e){return Object.keys(this.gameSteps).length>e?this.gameSteps[e]:null}},{key:\"playGame\",value:function(){this.initialise();for(var e=!1,t=1;!e;)this.gameSteps[t]=this.decisionLoop(),e=this.gameSteps[t].gameEnd,t++}},{key:\"decisionLoop\",value:function(){var e=this.checkDeath(),t={};for(var r in t.gameEnd=e,t.characters={},this.characterList)e?this.characterList[r].action.actionType=\"none\":this.makeDecision(this.characterList[r]);for(var r in this.resolveActions(),this.characterList){var n=JSON.stringify(this.characterList[r]);t.characters[r]=JSON.parse(n)}return t}},{key:\"makeDecision\",value:function(e){e.action.actionType=\"movement\"}},{key:\"resolveActions\",value:function(){for(var e in this.characterList)\"movement\"==this.characterList[e].action.actionType&&(this.characterList[e].position.x+=this.characterList[e].stats.movement),this.characterList[e].stats.health=0}},{key:\"checkDeath\",value:function(){var e=0;for(var t in this.characterList)this.characterList[t].stats.health>=1&&e++;return!(e>1)}},{key:\"initialise\",value:function(){i.default.writeToLog(\"Initialising game.\");var e=10;for(var t in this.characterList)this.characterList[t].position.x=e,e+=10;var r={gameEnd:!1};r.characters=this.characterList,this.gameSteps[0]=r}}]),e}();t.default=o}]);","extractedComments":[]}